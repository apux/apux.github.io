<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv='X-UA-Compatible' content='IE=edge;chrome=1' />
    <title>El Blog de ApuX - Matchers de RSpec para métodos booleanos</title>
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />
    <link href="/stylesheets/all.css" rel="stylesheet" type="text/css" />
  </head>
  <body>
    <div id="main" role="main">
      <nav>
  <ul>
    <li>
<a class="blog-title" href="/">        El Blog de Ap<span>uX</span>
</a>      <span class="caption">My Learning about Software Development</span>
    </li>
  </ul>
</nav>

      <section id="content">
          <article>
    <h1 class="heading">
      Matchers de RSpec para métodos booleanos
      <time>Oct  7 2013</time>
    </h1>
    <p>RSpec incluye una funcionalidad muy práctica al momento de probar métodos que
regresan falso o verdadero. Por convención, en Ruby estos métodos terminan con
un signo de interrogación que cierra: <code>?</code>.</p>

<p>Ejemplo:</p>
<pre class="highlight ruby"><code><span class="k">class</span> <span class="nc">Product</span>
  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">price</span><span class="p">)</span>
    <span class="vi">@price</span> <span class="o">=</span> <span class="n">price</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">expensive?</span>
    <span class="vi">@price</span> <span class="o">&gt;</span> <span class="mi">1000</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>

<p>En la clase vemos que el método <code>expensive?</code> nos regresa verdadero si el precio
del producto es mayor a 1000 y falso en caso contrario. La prueba en RSpec
sería como la que sigue:</p>
<pre class="highlight ruby"><code><span class="n">describe</span> <span class="no">Product</span> <span class="k">do</span>
  <span class="n">describe</span> <span class="s2">"#expensive?"</span> <span class="k">do</span>
    <span class="n">it</span> <span class="s1">'is false when price is less than 1000'</span> <span class="k">do</span>
      <span class="no">Product</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="mi">999</span><span class="p">).</span><span class="nf">expensive?</span><span class="p">.</span><span class="nf">should</span> <span class="o">==</span> <span class="kp">false</span>
    <span class="k">end</span>

    <span class="n">it</span> <span class="s1">'is false when price is equal to 1000'</span> <span class="k">do</span>
      <span class="no">Product</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="mi">1000</span><span class="p">).</span><span class="nf">expensive?</span><span class="p">.</span><span class="nf">should</span> <span class="o">==</span> <span class="kp">false</span>
    <span class="k">end</span>

    <span class="n">it</span> <span class="s1">'is true when price is greater than 1000'</span> <span class="k">do</span>
      <span class="no">Product</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="mi">1001</span><span class="p">).</span><span class="nf">expensive?</span><span class="p">.</span><span class="nf">should</span> <span class="o">==</span> <span class="kp">true</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>

<p>Lo que se prueba son los casos límite para nuestro escenario: que los precios
de 999 y 1000 hagan que nuestro producto no sea <em>expensive</em> y el precio de 1001
haga que sí lo sea.</p>

<p>La prueba es correcta y considero que los casos probados son los adecuados, sin
embargo, la sintaxis puede ser mejorada. RSpec integra algunos <em>matchers</em> que
permiten una sintaxis más concisa: todos los métodos que terminan con <code>?</code>
pueden ser verificados con el matcher <code>be_*</code>, donde <code>*</code> es el nombre del método
sin el signo de interrogación. En nuestro caso: <code>be_expensive</code>. La prueba
completa puede quedar de la siguiente manera:</p>
<pre class="highlight ruby"><code><span class="n">describe</span> <span class="no">Product</span> <span class="k">do</span>
  <span class="n">it</span> <span class="s1">'is not expensive when price is less than 1000'</span> <span class="k">do</span>
    <span class="no">Product</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="mi">999</span><span class="p">).</span><span class="nf">should_not</span> <span class="n">be_expensive</span>
  <span class="k">end</span>

  <span class="n">it</span> <span class="s1">'is not expensive when price is equal to 1000'</span> <span class="k">do</span>
    <span class="no">Product</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="mi">1000</span><span class="p">).</span><span class="nf">should_not</span> <span class="n">be_expensive</span>
  <span class="k">end</span>

  <span class="n">it</span> <span class="s1">'is expensive when price is greater than 1000'</span> <span class="k">do</span>
    <span class="no">Product</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="mi">1001</span><span class="p">).</span><span class="nf">should</span> <span class="n">be_expensive</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>

<p>El cambio es menor, pero permite una mejor lectura y eso siempre se agradece.</p>

  </article>
  <div id="disqus_thread"></div>
<script type="text/javascript">
//<![CDATA[
                  var disqus_shortname = 'elblogdeapux';
          
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
//]]>
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


      </section>
      <footer>
  <div class="container">
    <ul class="large-column">
      <li><h5 class="heading">Recent Articles</h5></li>
      <li>
        <ol>
            <li>
              <a href="/2015/08/31/how-to-install-postgresql-in-chakra-linux.html">How to Install Postgresql in Chakra Linux</a>
              <span>Aug 31</span>
            </li>
            <li>
              <a href="/2015/07/20/using-vim-regexp-to-update-to-rspec3-syntax.html">Using Vim Regexp to Update to RSpec 3 Syntax</a>
              <span>Jul 20</span>
            </li>
            <li>
              <a href="/2015/05/04/directory-tree.html">Directory tree</a>
              <span>May  4</span>
            </li>
            <li>
              <a href="/2015/04/13/directory-structure-conventions-in-rspec-and-minitest.html">Directory structure conventions in RSpec and Minitest</a>
              <span>Apr 13</span>
            </li>
            <li>
              <a href="/2015/01/12/joins-vs-includes-espanol.html">Joins vs Includes (Español)</a>
              <span>Jan 12</span>
            </li>
            <li>
              <a href="/2014/12/08/joins-vs-includes.html">Joins vs Includes</a>
              <span>Dec  8</span>
            </li>
            <li>
              <a href="/2014/09/01/minitest-v4-y-v5.html">Minitest v4 y  v5</a>
              <span>Sep  1</span>
            </li>
            <li>
              <a href="/2014/07/14/minitest-v4-and-v5.html">Minitest v4 and v5</a>
              <span>Jul 14</span>
            </li>
            <li>
              <a href="/2014/03/11/formularios-anidados.html">Formularios anidados</a>
              <span>Mar 11</span>
            </li>
            <li>
              <a href="/2014/02/10/como-solucionar-las-consultas-n-1-en-rails.html">Cómo solucionar consultas N+1 en Rails</a>
              <span>Feb 10</span>
            </li>
        </ol>
      </li>
    </ul>

    <ul class="small-column">
      <li><h5 class="heading">Tags</h5></li>
      <li>
        <ol>
            <li><a href="/tags/rails.html">Rails (8)</a></li>
            <li><a href="/tags/activerecord.html">ActiveRecord (7)</a></li>
            <li><a href="/tags/nested_attributes.html">nested_attributes (1)</a></li>
            <li><a href="/tags/formularios.html">formularios (1)</a></li>
            <li><a href="/tags/ruby.html">Ruby (5)</a></li>
            <li><a href="/tags/struct.html">Struct (1)</a></li>
            <li><a href="/tags/openstruct.html">OpenStruct (1)</a></li>
            <li><a href="/tags/asociaciones.html">Asociaciones (1)</a></li>
            <li><a href="/tags/minitest.html">Minitest (3)</a></li>
            <li><a href="/tags/postgresql.html">postgresql (1)</a></li>
            <li><a href="/tags/chakra.html">chakra (1)</a></li>
            <li><a href="/tags/vim.html">vim (1)</a></li>
            <li><a href="/tags/regexp.html">regexp (1)</a></li>
            <li><a href="/tags/rspec.html">rspec (1)</a></li>
            <li><a href="/tags/rspec.html">RSpec (2)</a></li>
            <li><a href="/tags/tree.html">tree (1)</a></li>
        </ol>
      </li>
      <ul>
  </div>
</footer>

    </div>
  </body>
</html>
